package Analizadores;
import java.io.FileReader;
import Principal.NCCSS;
import java_cup.runtime.Symbol;
import java_cup.runtime.*;
import java.util.ArrayList;

/*codigo publico*/
parser code {:
    public static ArrayList<Nodo_error> Errores = new ArrayList<Nodo_error>();
    public static boolean errores=false;
    protected int error_sync_size () {
       return 1;   
    }

    public void syntax_error(Symbol s){
        System.out.println("Error sintactico lexema \"" + s.value+"\" en la Columna: "+(s.right) +", Linea: "+(s.left+1)+ " no esperado");
        Nodo_error nuevo = new Nodo_error();
        nuevo.dato = String.valueOf(s.value);
        nuevo.linea = (s.left+1);
        nuevo.columna=(s.right);
        Errores.add(nuevo);
        errores=true;
    }

    
    public void unrecovered_syntax_error(Symbol s) throws java.lang.Exception{
        System.out.println("Error sintactico \"" + s.value+"\" en la Linea: "+(s.right+1) +", Columna: "+(s.left+1)+ "");
        Nodo_error nuevo = new Nodo_error();
        nuevo.dato = String.valueOf(s.value);
        nuevo.linea = (s.left+1);
        nuevo.columna=(s.right);
        Errores.add(nuevo);
        errores=true;
    }
    public NCCSS regresar_raiz(){
        return RCCSS;
    }

 /*codig de usuario */
 String total = "";
 public NCCSS RCCSS = null;
 public ArrayList<Nodo> e = new ArrayList<Nodo>();
:}
action code {:
    public String estado="";
:}
/* terminales del lenguaje*/
terminal PID,SCOM,SMAS,SMEN,SDPU,SIGU,SMUL,SDIV,SICO,RHOR,RVER,SFCO,SIPA,SPYC,SFPA,RID,RTEX,RCUR,RLET,RGRU,ROPA,RBOR,RVIS,RFOR,RDER,CUR,RCEN,RNEG,RALI,RIZQ,RMAY,RMIN,RCAP,RCOL,RJUS,RFEL,RAUR;
/*aqui estan los no terminales */
non terminal Start,UNO; 
non terminal N_CCSS;
precedence left terminal SMAS,SMEN,SMUL,SDIV; 
start with Start;
Start ::= UNO;
UNO ::= ESTRUCTURA_CSS:e1   {:RCCSS =e1;:};
/*estructura de CSS*/
ESTRUCTURA_CSS  ::= ESTRUCTURA_CSS:e2 ESTRUCTURA_ID:e1  {:e2.hijos.add(e1);:}
                |   ESTRUCTURA_ID:e1                    {:return e1;:};
/*estructura de ID*/
ESTRUCTURA_ID   ::= PID:e1     SICO CUERPO_ID:e2 SFCO    {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="inicio"; nuevo.valor=e1; nuevo.hijos.add(e2); return nuevo;:};
CUERPO_ID       ::= CUERPO_ID:e2 ESTRUCTURA_GENE:e1      {:e2.hijos.add(e1); return e2;:}
                |   ESTRUCTURA_GENE:e1                   {:return e1;:};
/*estructura de alineado*/
ESTRUCTURA_ALIN ::= RALI SDPU SIGU RIZQ{:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="alineado"; nuevo.valor="izquierdo"; return nuevo;:}
                |   RALI SDPU SIGU RDER{:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="alineado"; nuevo.valor="derecha"; return nuevo;:}
                |   RALI SDPU SIGU RCEN{:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="alineado"; nuevo.valor="centrado"; return nuevo;:}
                |   RALI SDPU SIGU RJUS{:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="alineado"; nuevo.valor="justificado"; return nuevo;:};
/*estructura de texto*/
ESTRUCTURA_TEXT ::= RTEX SDPU SIGU EXPRESION:e1 SPYC{:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="texto"; nuevo.valor=e1; return nuevo;:};
/*estructura de letra*/
ESTRUCTURA_LETR ::= RLET SDPU SIGU EXPRESION:e1 SPYC{:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="letra"; nuevo.valor=e1; return nuevo;:};
/*estructura de tamtex*/
ESTRUCTURA_TAMT ::= RTAM SDPU SIGU EXPRESION:e1 SPYC{:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="tama√±io"; nuevo.valor=e1; return nuevo;:};
/*estructura de Fondoelemnto*/
ESTRUCTURA_FOND ::= RFEL SDPU SIGU EXPRESION:e1 SPYC{:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Fondoelemento"; nuevo.valor=e1; return nuevo;:};
/*estructura de AUTOREDIMENSION*/
ESTRUCTURA_AUTO ::= RAUR SDPU SIGU SICO PID:e1 SCOM RHOR SFCO SPYC{:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="AUTOREDIMENSION"; nuevo.valor=e1+",0"; return nuevo;:}
                |   RAUR SDPU SIGU SICO PID:e1 SCOM RVER SFCO SPYC{:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="AUTOREDIMENSION"; nuevo.valor=e1+",1"; return nuevo;:};
/*estructura de VISIBLE*/
ESTRUCTURA_VISI ::= RVIS SDPU SIGU PID:e1 SPYC      {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="visible"; nuevo.valor=e1; return nuevo;:};
/*estructura de Opaque*/
ESTRUCTURA_OPAQ ::= ROPA SDPU SIGU PID:e1 SPYC      {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="opaque"; nuevo.valor=e1; return nuevo;:};
/*estructura de colortext*/
ESTRUCTURA_COLT ::= RCOL SDPU SIGU EXPRESION:e1 SPYC{:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="colortext"; nuevo.valor=e1; return nuevo;:};
/*estructura de BORDE*/
ESTRUCTURA_BORD ::= RBOR SDPU SIGU SICO EXPRESION:e1 SCOM EXPRESION:e2 SCOM PID:e3 SFCO SPYC{:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Borde"; nuevo.valor=e1+"/"+e2+"/"+e3; return nuevo;:};
/*estructura de formatos*/
ESTRUCTURA_FORM ::= RFOR SDPU SIGU Lista_For:e1 {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="formato"; nuevo.hijos.add(e1); return nuevo;:}; 
Lista_For       ::= Lista_For:e1 SCOM RNEG      {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Lista_For"; nuevo.valor="negrita"; return nuevo; e1.hijos.add(nuevo); return e1;:}
                |   Lista_For:e1 SCOM RCUR      {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Lista_For"; nuevo.valor="cursiva"; return nuevo; e1.hijos.add(nuevo); return e1;:}
                |   Lista_For:e1 SCOM RMAY      {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Lista_For"; nuevo.valor="mayuscula"; return nuevo; e1.hijos.add(nuevo); return e1;:}
                |   Lista_For:e1 SCOM RMIN      {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Lista_For"; nuevo.valor="minuscula"; return nuevo; e1.hijos.add(nuevo); return e1;:}
                |   Lista_For:e1 SCOM RCAP      {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Lista_For"; nuevo.valor="capital-T"; return nuevo; e1.hijos.add(nuevo); return e1;:}
                |                     RNEG      {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Lista_For"; nuevo.valor="negrita"; return nuevo;:}
                |                     RCUR      {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Lista_For"; nuevo.valor="cursiva"; return nuevo;:}
                |                     RMAY      {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Lista_For"; nuevo.valor="mayuscula"; return nuevo;:}
                |                     RMIN      {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Lista_For"; nuevo.valor="minuscula"; return nuevo;:}
                |                     RCAP      {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Lista_For"; nuevo.valor="capital-T"; return nuevo;:};               
/*estructura de General*/
ESTRUCTURA_GENE ::= RID  SIPA PID:e2 SFPA SPYC CUERPO_GEN:e1   {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="ID"; nuevo.valor=e2; nuevo.hijos.add(e1); return nuevo;:}
                |   RGRU SIPA PID:e2 SFPA SPYC CUERPO_GEN:e1   {:NCCSS nuevo = new NCCSS(); nuevo.etiqueta="Grupo"; nuevo.valor=e2;nuevo.hijos.add(e1); return nuevo;:};

CUERPO_GENE     ::= CUERPO_GENE:e2 TIPO_CUERPO_G:e1 {:e2.hijos.add(e1); return e2;:}              
                |   TIPO_CUERPO_G:e1                {:return e1;:};

TIPO_CUERPO_G ::=   ESTRUCTURA_AUTO:e1      {:return e1;:}              
                |   ESTRUCTURA_VISI:e1      {:return e1;:}              
                |   ESTRUCTURA_COLT:e1      {:return e1;:} 
                |   ESTRUCTURA_OPAQ:e1      {:return e1;:}              
                |   ESTRUCTURA_FOND:e1      {:return e1;:}              
                |   ESTRUCTURA_BORD:e1      {:return e1;:}              
                |   ESTRUCTURA_ALIN:e1      {:return e1;:}              
                |   ESTRUCTURA_TEXT:e1      {:return e1;:}              
                |   ESTRUCTURA_TAMT:e1      {:return e1;:}
                |   ESTRUCTURA_FORM:e1      {:return e1;:}
                |   ESTRUCTURA_LETR:e1      {:return e1;:};                